# Overnight Improvement 夜間優化 Agent

## 📋 概述

Overnight Improvement agent 在凌晨 2 點分析程式碼品質，自動執行輕量級重構和效能優化，並生成改進報告。

## 🎯 目的

- **程式碼分析**：使用 ESLint 和靜態分析工具掃描專案
- **自動修復**：執行安全的自動修復（格式化、未使用變數）
- **效能檢測**：識別潛在的效能瓶頸
- **技術債報告**：統計 TODO、FIXME 註解

## ⚙️ 設定

```yaml
名稱: overnight-improvement
排程: "0 2 * * *"  # 每天凌晨 02:00
逾時: 600000       # 10 分鐘
記憶體限制: 200M
```

## 📊 分析項目

```
檢查清單：
  ├─ ESLint 規則違反
  ├─ TypeScript 型別錯誤
  ├─ 未使用的 imports/variables
  ├─ 重複程式碼區塊
  ├─ 大型函數（>50 行）
  └─ 循環複雜度（McCabe > 10）

自動修復：
  ✅ 程式碼格式化（Prettier）
  ✅ Import 排序
  ✅ 移除未使用變數
  ✅ 簡化 if-else 邏輯

手動檢視：
  ⚠️ 效能瓶頸建議
  ⚠️ 架構改進建議
  ⚠️ 安全性警告
```

## 🔧 依賴套件

| 套件 | 版本 | 用途 |
|------|------|------|
| eslint | ^8.50.0 | 程式碼檢查 |
| prettier | ^3.0.0 | 格式化 |
| @anthropic-ai/sdk | ^0.32.0 | AI 建議 |

## 📝 範例輸出

```markdown
# 夜間優化報告 - 2026-02-14

## ✅ 自動修復
- 格式化 12 個檔案
- 移除 8 個未使用的 imports
- 簡化 3 個 if-else 區塊

## ⚠️ 需要檢視
- `src/components/Board.jsx:45` - 建議使用 useMemo
- `src/api/client.js:120` - 錯誤處理不完整
- `src/utils/parser.js:30` - 循環複雜度過高（15）

## 📊 統計
- 總行數：8,542
- 技術債註解：15 個 TODO, 3 個 FIXME
- 平均函數長度：18 行
- 測試覆蓋率：68%
```

## 📈 效能指標

- **平均執行時間**：3-5 分鐘
- **掃描檔案數**：約 100-150 個
- **記憶體使用**：尖峰 120-150 MB

## 🔍 監控

日誌儲存於：`~/.openclaw/logs/overnight-improvement.log`

## 🛠️ 故障排除

### 問題：ESLint 掃描失敗
**解決方案**：確認 `.eslintrc` 設定檔正確

### 問題：自動修復導致測試失敗
**解決方案**：檢查 git diff，必要時 revert

---

**最後更新**：2026-02-14
**維護者**：AI 系統
**版本**：1.0
